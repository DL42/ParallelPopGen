<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.12"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Parallel PopGen Package: GO_Fish Namespace Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script><script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Parallel PopGen Package
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.12 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('namespace_g_o___fish.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#nested-classes">Classes</a> &#124;
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">GO_Fish Namespace Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>Namespace for single-locus, forward, Monte-Carlo Wright-Fisher simulation and output data structures.  
<a href="#details">More...</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="nested-classes"></a>
Classes</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="struct_g_o___fish_1_1allele__trajectories.html">allele_trajectories</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">control and output data structure for <a class="el" href="namespace_g_o___fish.html" title="Namespace for single-locus, forward, Monte-Carlo Wright-Fisher simulation and output data structures...">GO_Fish</a> simulation  <a href="struct_g_o___fish_1_1allele__trajectories.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="struct_g_o___fish_1_1mut_i_d.html">mutID</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">structure specifying the ID for a mutation in a <a class="el" href="namespace_g_o___fish.html" title="Namespace for single-locus, forward, Monte-Carlo Wright-Fisher simulation and output data structures...">GO_Fish</a> simulation  <a href="struct_g_o___fish_1_1mut_i_d.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a7e11d273a799f6ddbda24e3115a49083"><td class="memTemplParams" colspan="2">template&lt;typename Functor_mutation , typename Functor_demography , typename Functor_migration , typename Functor_selection , typename Functor_inbreeding , typename Functor_dominance , typename Functor_preserve , typename Functor_timesample &gt; </td></tr>
<tr class="memitem:a7e11d273a799f6ddbda24e3115a49083"><td class="memTemplItemLeft" align="right" valign="top">__host__ void&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="namespace_g_o___fish.html#a7e11d273a799f6ddbda24e3115a49083">run_sim</a> (<a class="el" href="struct_g_o___fish_1_1allele__trajectories.html">allele_trajectories</a> &amp;all_results, const Functor_mutation mu_rate, const Functor_demography demography, const Functor_migration mig_prop, const Functor_selection sel_coeff, const Functor_inbreeding FI, const Functor_dominance dominance, const Functor_preserve preserve_mutations, const Functor_timesample take_sample)</td></tr>
<tr class="memdesc:a7e11d273a799f6ddbda24e3115a49083"><td class="mdescLeft">&#160;</td><td class="mdescRight">runs a single-locus Wright-Fisher simulation specified by the given simulation functions and sim_constants, storing the results into <code>all_results</code>  <a href="#a7e11d273a799f6ddbda24e3115a49083">More...</a><br /></td></tr>
<tr class="separator:a7e11d273a799f6ddbda24e3115a49083"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a834fcc7ee0053108d5ad988c3e5a3541"><td class="memTemplParams" colspan="2">template&lt;typename Functor_mutation , typename Functor_demography , typename Functor_migration , typename Functor_selection , typename Functor_inbreeding , typename Functor_dominance , typename Functor_preserve , typename Functor_timesample &gt; </td></tr>
<tr class="memitem:a834fcc7ee0053108d5ad988c3e5a3541"><td class="memTemplItemLeft" align="right" valign="top">__host__ void&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="namespace_g_o___fish.html#a834fcc7ee0053108d5ad988c3e5a3541">run_sim</a> (<a class="el" href="struct_g_o___fish_1_1allele__trajectories.html">allele_trajectories</a> &amp;all_results, const Functor_mutation mu_rate, const Functor_demography demography, const Functor_migration mig_prop, const Functor_selection sel_coeff, const Functor_inbreeding FI, const Functor_dominance dominance, const Functor_preserve preserve_mutations, const Functor_timesample take_sample, const <a class="el" href="struct_g_o___fish_1_1allele__trajectories.html">allele_trajectories</a> &amp;prev_sim)</td></tr>
<tr class="memdesc:a834fcc7ee0053108d5ad988c3e5a3541"><td class="mdescLeft">&#160;</td><td class="mdescRight">runs a single-locus Wright-Fisher simulation specified by the given simulation functions and sim_constants, storing the results into <code>all_results</code>  <a href="#a834fcc7ee0053108d5ad988c3e5a3541">More...</a><br /></td></tr>
<tr class="separator:a834fcc7ee0053108d5ad988c3e5a3541"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afce33e40bd359582edc7fbeb9efd6d06"><td class="memItemLeft" align="right" valign="top">std::ostream &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespace_g_o___fish.html#afce33e40bd359582edc7fbeb9efd6d06">operator&lt;&lt;</a> (std::ostream &amp;stream, const <a class="el" href="struct_g_o___fish_1_1mut_i_d.html">mutID</a> &amp;id)</td></tr>
<tr class="memdesc:afce33e40bd359582edc7fbeb9efd6d06"><td class="mdescLeft">&#160;</td><td class="mdescRight">insertion operator: sends <code><a class="el" href="struct_g_o___fish_1_1mut_i_d.html" title="structure specifying the ID for a mutation in a GO_Fish simulation ">mutID</a> id</code> into the <code>ostream stream</code>  <a href="#afce33e40bd359582edc7fbeb9efd6d06">More...</a><br /></td></tr>
<tr class="separator:afce33e40bd359582edc7fbeb9efd6d06"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a15271021c02e8332d967313da82736cd"><td class="memItemLeft" align="right" valign="top">std::ostream &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespace_g_o___fish.html#a15271021c02e8332d967313da82736cd">operator&lt;&lt;</a> (std::ostream &amp;stream, <a class="el" href="struct_g_o___fish_1_1allele__trajectories.html">allele_trajectories</a> &amp;A)</td></tr>
<tr class="memdesc:a15271021c02e8332d967313da82736cd"><td class="mdescLeft">&#160;</td><td class="mdescRight">insertion operator: sends <code><a class="el" href="struct_g_o___fish_1_1allele__trajectories.html" title="control and output data structure for GO_Fish simulation ">allele_trajectories</a> A</code> into the <code>ostream stream</code>  <a href="#a15271021c02e8332d967313da82736cd">More...</a><br /></td></tr>
<tr class="separator:a15271021c02e8332d967313da82736cd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a64c0dc811a89af3eec83cf9a4d31885d"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespace_g_o___fish.html#a64c0dc811a89af3eec83cf9a4d31885d">swap</a> (<a class="el" href="struct_g_o___fish_1_1allele__trajectories.html">allele_trajectories</a> &amp;a, <a class="el" href="struct_g_o___fish_1_1allele__trajectories.html">allele_trajectories</a> &amp;b)</td></tr>
<tr class="memdesc:a64c0dc811a89af3eec83cf9a4d31885d"><td class="mdescLeft">&#160;</td><td class="mdescRight">swaps data held by <a class="el" href="struct_g_o___fish_1_1allele__trajectories.html" title="control and output data structure for GO_Fish simulation ">allele_trajectories</a> a and b  <a href="#a64c0dc811a89af3eec83cf9a4d31885d">More...</a><br /></td></tr>
<tr class="separator:a64c0dc811a89af3eec83cf9a4d31885d"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Namespace for single-locus, forward, Monte-Carlo Wright-Fisher simulation and output data structures. </p>
<p><a class="el" href="namespace_g_o___fish.html" title="Namespace for single-locus, forward, Monte-Carlo Wright-Fisher simulation and output data structures...">GO_Fish</a> is a single-locus Wright-Fisher forward simulation where individual sites are assumed to be independent from each other and mutations are irreversible (Poisson Random Field model). Mutations are the “unit” of simulation for the single-locus Wright-Fisher algorithm. Thus a generation of organisms is represented by an array of mutations and their frequency in the (each) population (if there are multiple in the simulation). There are several options for how to initialize the mutation array to start a simulation: a blank mutation array, the output of a previous simulation run, or mutation-selection equilibrium. Simulating each discrete generation consists of calculating the new allele frequency of each mutation after a round of migration, selection, and drift. Concurrently, new mutations are added to the array. Those mutations that become lost or fixed are discarded in a compact step. The resulting offspring array of mutation frequencies becomes the parent array of the next generation and the cycle is repeated until the end of the simulation when the final mutation array is output. Further, the user can sample individual generations in the simulation. <br />
<br />
The function <code>run_sim</code> runs a <a class="el" href="namespace_g_o___fish.html" title="Namespace for single-locus, forward, Monte-Carlo Wright-Fisher simulation and output data structures...">GO_Fish</a> simulation (see documentation for <code>run_sim</code> below). The sampled and final generations are stored in <a class="el" href="struct_g_o___fish_1_1allele__trajectories.html" title="control and output data structure for GO_Fish simulation ">allele_trajectories</a> <code>all_results</code>. <code>all_results</code> stores the frequency(ies) in the population(s) and <a class="el" href="struct_g_o___fish_1_1mut_i_d.html" title="structure specifying the ID for a mutation in a GO_Fish simulation ">mutID</a> of every mutation in the sample in RAM, from which population genetics statistics can be calculated or which can be manipulated and output as the user sees fit. <br />
<br />
To use all <a class="el" href="namespace_g_o___fish.html" title="Namespace for single-locus, forward, Monte-Carlo Wright-Fisher simulation and output data structures...">GO_Fish</a> functions and objects, include header file: <a class="el" href="go__fish_8cuh.html" title="GO Fish Simulation API (contains namespaces GO_Fish and Sim_Model) ">go_fish.cuh</a>. <br />
 Optionally, to use only the <a class="el" href="namespace_g_o___fish.html" title="Namespace for single-locus, forward, Monte-Carlo Wright-Fisher simulation and output data structures...">GO_Fish</a> data structures, include header file: <a class="el" href="go__fish__data__struct_8h.html" title="Subset of go_fish.cuh (the GO_Fish data structures) ">go_fish_data_struct.h</a>. </p>
</div><h2 class="groupheader">Function Documentation</h2>
<a id="a7e11d273a799f6ddbda24e3115a49083"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7e11d273a799f6ddbda24e3115a49083">&sect;&nbsp;</a></span>run_sim() <span class="overload">[1/2]</span></h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename Functor_mutation , typename Functor_demography , typename Functor_migration , typename Functor_selection , typename Functor_inbreeding , typename Functor_dominance , typename Functor_preserve , typename Functor_timesample &gt; </div>
      <table class="memname">
        <tr>
          <td class="memname">__host__ void GO_Fish::run_sim </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="struct_g_o___fish_1_1allele__trajectories.html">allele_trajectories</a> &amp;&#160;</td>
          <td class="paramname"><em>all_results</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const Functor_mutation&#160;</td>
          <td class="paramname"><em>mu_rate</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const Functor_demography&#160;</td>
          <td class="paramname"><em>demography</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const Functor_migration&#160;</td>
          <td class="paramname"><em>mig_prop</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const Functor_selection&#160;</td>
          <td class="paramname"><em>sel_coeff</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const Functor_inbreeding&#160;</td>
          <td class="paramname"><em>FI</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const Functor_dominance&#160;</td>
          <td class="paramname"><em>dominance</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const Functor_preserve&#160;</td>
          <td class="paramname"><em>preserve_mutations</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const Functor_timesample&#160;</td>
          <td class="paramname"><em>take_sample</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>runs a single-locus Wright-Fisher simulation specified by the given simulation functions and sim_constants, storing the results into <code>all_results</code> </p>
<p>calls <code>run_sim(..., const <a class="el" href="struct_g_o___fish_1_1allele__trajectories.html" title="control and output data structure for GO_Fish simulation ">allele_trajectories</a> &amp; prev_sim)</code> with <code>prev_sim</code> set to a blank allele_trajectory. Saves on some unnecessary typing when starting from mutation-selection-equilibrium or a blank simulation. <br />
<br />
</p><pre class="fragment"></pre><p> <br />
 Below is the description for function <code>run_sim(..., const <a class="el" href="struct_g_o___fish_1_1allele__trajectories.html" title="control and output data structure for GO_Fish simulation ">allele_trajectories</a> &amp; prev_sim)</code>: <br />
<br />
 A simulation run is controlled by the template functions and <a class="el" href="struct_g_o___fish_1_1allele__trajectories.html#aeb34bc193f8493c481313a83163f931f" title="constants for initializing the next simulation ">allele_trajectories.sim_input_constants</a> (which are then accessible from <a class="el" href="struct_g_o___fish_1_1allele__trajectories.html#a3d476cbaddd6480a8816e48a09cca6a7" title="returns sim_constants of the simulation currently held by allele_trajectories ">allele_trajectories.last_run_constants()</a> even if the input constants are later changed). The user can write their own simulation functions to input into <code>run_sim</code> or use those provided in namespace <a class="el" href="namespace_sim___model.html" title="Namespace of functions for controlling GO_Fish simulations. ">Sim_Model</a>. For details on how to write your own simulation functions, go to the <a href="modules.html">Modules</a> page, click on the simulation function group which describes the function you wish to write, and read its detailed description. They can be standard functions, functors, or (coming with C+11 support) lambdas.</p>
<p><b>Pro Tip:</b> For extra speed, it is desirable that the simulation functions input into run_sim are known at compile-time (i.e. avoid function pointers and non-inline functions unless necessary). The parameters input into the constructors of functors (as used by <a class="el" href="namespace_sim___model.html" title="Namespace of functions for controlling GO_Fish simulations. ">Sim_Model</a>) may be set at runtime, but the the function itself (the structure/operator in the case of a functor) should be known at compile-time. The functions are input into <code>run_sim</code> via templates, so that, at compile-time, known functions can be compiled directly into run_sim's code (fast) as opposed to called from the function stack (slow). This is especially important for Selection, Migration, and, to a lesser extent, Demographic functions, which are run on the GPU many times over for every mutation, every generation (on the GPU every mutation, every compact generation for Demography).</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">all_results</td><td><code>all_results.sim_input_constants</code> help control the simulation run whose results are stored in <code>all_results</code> </td></tr>
    <tr><td class="paramname">mu_rate</td><td>Function specifying the mutation rate per site for a given <code>population</code>, <code>generation</code> </td></tr>
    <tr><td class="paramname">demography</td><td>Function specifying then population size (individuals) for a given <code>population</code>, <code>generation</code> </td></tr>
    <tr><td class="paramname">mig_prop</td><td>Function specifying the migration rate, which is the proportion of chromosomes in population <code>pop_TO</code> from population <code>pop_FROM</code> for a given <code>generation</code> </td></tr>
    <tr><td class="paramname">sel_coeff</td><td>Function specifying the selection coefficient for a given <code>population</code>, <code>generation</code>, <code>frequency</code> </td></tr>
    <tr><td class="paramname">FI</td><td>Function specifying the inbreeding coefficient for a given <code>population</code>, <code>generation</code> </td></tr>
    <tr><td class="paramname">dominance</td><td>Function specifying the dominance coefficient for a given <code>population</code>, <code>generation</code> </td></tr>
    <tr><td class="paramname">preserve_mutations</td><td>Function specifying if the mutations extant in a <code>generation</code> should be preserved for the rest of the simulation run </td></tr>
    <tr><td class="paramname">take_sample</td><td>Function specifying if a time sample should be taken in a <code>generation</code> - note this will automatically preserve those mutations for the rest of the simulation run </td></tr>
    <tr><td class="paramname">prev_sim</td><td>if <code>prev_sim_sample</code> in <code>all_results.sim_input_constants</code> is greater than 0 (and less than the number of time samples in <code>prev_sim</code>), then <code>run_sim</code> will use the corresponding time sample in prev_sim to initialize the new simulation provided that the number of populations and number of sites are equivalent to those in <code>all_results.sim_input_constants</code> or an error will be thrown. </td></tr>
  </table>
  </dd>
</dl>
<dl><dt><b>Examples: </b></dt><dd><a class="el" href="_example1-_speed-example.html#a12">Example1-Speed</a>, <a class="el" href="_example2-_da_di-example.html#a18">Example2-DaDi</a>, and <a class="el" href="_example3-_compilation-example.html#a16">Example3-Compilation</a>.</dd>
</dl>
<p>Definition at line <a class="el" href="go__fish__impl_8cuh_source.html#l00701">701</a> of file <a class="el" href="go__fish__impl_8cuh_source.html">go_fish_impl.cuh</a>.</p>

</div>
</div>
<a id="a834fcc7ee0053108d5ad988c3e5a3541"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a834fcc7ee0053108d5ad988c3e5a3541">&sect;&nbsp;</a></span>run_sim() <span class="overload">[2/2]</span></h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename Functor_mutation , typename Functor_demography , typename Functor_migration , typename Functor_selection , typename Functor_inbreeding , typename Functor_dominance , typename Functor_preserve , typename Functor_timesample &gt; </div>
      <table class="memname">
        <tr>
          <td class="memname">__host__ void GO_Fish::run_sim </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="struct_g_o___fish_1_1allele__trajectories.html">allele_trajectories</a> &amp;&#160;</td>
          <td class="paramname"><em>all_results</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const Functor_mutation&#160;</td>
          <td class="paramname"><em>mu_rate</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const Functor_demography&#160;</td>
          <td class="paramname"><em>demography</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const Functor_migration&#160;</td>
          <td class="paramname"><em>mig_prop</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const Functor_selection&#160;</td>
          <td class="paramname"><em>sel_coeff</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const Functor_inbreeding&#160;</td>
          <td class="paramname"><em>FI</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const Functor_dominance&#160;</td>
          <td class="paramname"><em>dominance</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const Functor_preserve&#160;</td>
          <td class="paramname"><em>preserve_mutations</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const Functor_timesample&#160;</td>
          <td class="paramname"><em>take_sample</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="struct_g_o___fish_1_1allele__trajectories.html">allele_trajectories</a> &amp;&#160;</td>
          <td class="paramname"><em>prev_sim</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>runs a single-locus Wright-Fisher simulation specified by the given simulation functions and sim_constants, storing the results into <code>all_results</code> </p>
<p>A simulation run is controlled by the template functions and <a class="el" href="struct_g_o___fish_1_1allele__trajectories.html#aeb34bc193f8493c481313a83163f931f" title="constants for initializing the next simulation ">allele_trajectories.sim_input_constants</a> (which are then accessible from <a class="el" href="struct_g_o___fish_1_1allele__trajectories.html#a3d476cbaddd6480a8816e48a09cca6a7" title="returns sim_constants of the simulation currently held by allele_trajectories ">allele_trajectories.last_run_constants()</a> even if the input constants are later changed). The user can write their own simulation functions to input into <code>run_sim</code> or use those provided in namespace <a class="el" href="namespace_sim___model.html" title="Namespace of functions for controlling GO_Fish simulations. ">Sim_Model</a>. For details on how to write your own simulation functions, go to the <a href="modules.html">Modules</a> page, click on the simulation function group which describes the function you wish to write, and read its detailed description. They can be standard functions, functors, or (coming with C+11 support) lambdas.</p>
<p><b>Pro Tip:</b> For extra speed, it is desirable that the simulation functions input into run_sim are known at compile-time (i.e. avoid function pointers and non-inline functions unless necessary). The parameters input into the constructors of functors (as used by <a class="el" href="namespace_sim___model.html" title="Namespace of functions for controlling GO_Fish simulations. ">Sim_Model</a>) may be set at runtime, but the the function itself (the structure/operator in the case of a functor) should be known at compile-time. The functions are input into <code>run_sim</code> via templates, so that, at compile-time, known functions can be compiled directly into run_sim's code (fast) as opposed to called from the function stack (slow). This is especially important for Selection, Migration, and, to a lesser extent, Demographic functions, which are run on the GPU many times over for every mutation, every generation (on the GPU every mutation, every compact generation for Demography).</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">all_results</td><td><code>all_results.sim_input_constants</code> help control the simulation run whose results are stored in <code>all_results</code> </td></tr>
    <tr><td class="paramname">mu_rate</td><td>Function specifying the mutation rate per site for a given <code>population</code>, <code>generation</code> </td></tr>
    <tr><td class="paramname">demography</td><td>Function specifying then population size (individuals) for a given <code>population</code>, <code>generation</code> </td></tr>
    <tr><td class="paramname">mig_prop</td><td>Function specifying the migration rate, which is the proportion of chromosomes in population <code>pop_TO</code> from population <code>pop_FROM</code> for a given <code>generation</code> </td></tr>
    <tr><td class="paramname">sel_coeff</td><td>Function specifying the selection coefficient for a given <code>population</code>, <code>generation</code>, <code>frequency</code> </td></tr>
    <tr><td class="paramname">FI</td><td>Function specifying the inbreeding coefficient for a given <code>population</code>, <code>generation</code> </td></tr>
    <tr><td class="paramname">dominance</td><td>Function specifying the dominance coefficient for a given <code>population</code>, <code>generation</code> </td></tr>
    <tr><td class="paramname">preserve_mutations</td><td>Function specifying if the mutations extant in a <code>generation</code> should be preserved for the rest of the simulation run </td></tr>
    <tr><td class="paramname">take_sample</td><td>Function specifying if a time sample should be taken in a <code>generation</code> - note this will automatically preserve those mutations for the rest of the simulation run </td></tr>
    <tr><td class="paramname">prev_sim</td><td>if <code>prev_sim_sample</code> in <code>all_results.sim_input_constants</code> is greater than 0 (and less than the number of time samples in <code>prev_sim</code>), then <code>run_sim</code> will use the corresponding time sample in prev_sim to initialize the new simulation provided that the number of populations and number of sites are equivalent to those in <code>all_results.sim_input_constants</code> or an error will be thrown. </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="go__fish__impl_8cuh_source.html#l00730">730</a> of file <a class="el" href="go__fish__impl_8cuh_source.html">go_fish_impl.cuh</a>.</p>

</div>
</div>
<a id="afce33e40bd359582edc7fbeb9efd6d06"></a>
<h2 class="memtitle"><span class="permalink"><a href="#afce33e40bd359582edc7fbeb9efd6d06">&sect;&nbsp;</a></span>operator<<() <span class="overload">[1/2]</span></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::ostream &amp; GO_Fish::operator&lt;&lt; </td>
          <td>(</td>
          <td class="paramtype">std::ostream &amp;&#160;</td>
          <td class="paramname"><em>stream</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="struct_g_o___fish_1_1mut_i_d.html">mutID</a> &amp;&#160;</td>
          <td class="paramname"><em>id</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>insertion operator: sends <code><a class="el" href="struct_g_o___fish_1_1mut_i_d.html" title="structure specifying the ID for a mutation in a GO_Fish simulation ">mutID</a> id</code> into the <code>ostream stream</code> </p>
<p>returns <code>ostream stream</code> containing string <code>id.toString()</code> <br />
<br />
 string format: (origin_generation,origin_population,origin_thread,reserved) <br />
<br />
 Stream can be fed into terminal output, file output, or into an <code>istream</code> for extraction with the <code>&gt;&gt;</code> operator. </p>

<p>Definition at line <a class="el" href="inline__go__fish__data__struct_8hpp_source.html#l00198">198</a> of file <a class="el" href="inline__go__fish__data__struct_8hpp_source.html">inline_go_fish_data_struct.hpp</a>.</p>

</div>
</div>
<a id="a15271021c02e8332d967313da82736cd"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a15271021c02e8332d967313da82736cd">&sect;&nbsp;</a></span>operator<<() <span class="overload">[2/2]</span></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::ostream &amp; GO_Fish::operator&lt;&lt; </td>
          <td>(</td>
          <td class="paramtype">std::ostream &amp;&#160;</td>
          <td class="paramname"><em>stream</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="struct_g_o___fish_1_1allele__trajectories.html">allele_trajectories</a> &amp;&#160;</td>
          <td class="paramname"><em>A</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>insertion operator: sends <code><a class="el" href="struct_g_o___fish_1_1allele__trajectories.html" title="control and output data structure for GO_Fish simulation ">allele_trajectories</a> A</code> into the <code>ostream stream</code> </p>
<p>returns <code>ostream stream</code> containing the last simulation run information stored by <code><a class="el" href="struct_g_o___fish_1_1allele__trajectories.html" title="control and output data structure for GO_Fish simulation ">allele_trajectories</a> A</code> <br />
<br />
First function inserts the run constants (not input constants) held by <code>A</code> into the output stream with the variable name tab-delimited from its value. This is followed by the feature information (e.g. generation, number of mutations, population size, population extinction) from each time sample (if any). Each feature of a time sample is a row in the stream while each time sample is a major column and each population is a minor column. Finally, the allele trajectory of each mutation (if any) is added to the stream. The allele trajectories are mutation row-ordered (by <code>origin_generation</code> then <code>origin_population</code> then <code>origin_threadID</code>), where each major column is a time sample and each minor column is a population. All columns are tab-delimited. An example is provided in example_compilation/bfile.dat. <br />
<br />
Stream can be fed into terminal output, file output, or into an <code>istream</code> for extraction with the <code>&gt;&gt;</code> operator. </p>

<p>Definition at line <a class="el" href="inline__go__fish__data__struct_8hpp_source.html#l00208">208</a> of file <a class="el" href="inline__go__fish__data__struct_8hpp_source.html">inline_go_fish_data_struct.hpp</a>.</p>

</div>
</div>
<a id="a64c0dc811a89af3eec83cf9a4d31885d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a64c0dc811a89af3eec83cf9a4d31885d">&sect;&nbsp;</a></span>swap()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void GO_Fish::swap </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="struct_g_o___fish_1_1allele__trajectories.html">allele_trajectories</a> &amp;&#160;</td>
          <td class="paramname"><em>a</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="struct_g_o___fish_1_1allele__trajectories.html">allele_trajectories</a> &amp;&#160;</td>
          <td class="paramname"><em>b</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>swaps data held by <a class="el" href="struct_g_o___fish_1_1allele__trajectories.html" title="control and output data structure for GO_Fish simulation ">allele_trajectories</a> a and b </p>

<p>Definition at line <a class="el" href="inline__go__fish__data__struct_8hpp_source.html#l00269">269</a> of file <a class="el" href="inline__go__fish__data__struct_8hpp_source.html">inline_go_fish_data_struct.hpp</a>.</p>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="namespace_g_o___fish.html">GO_Fish</a></li>
    <li class="footer">Generated by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.12 </li>
  </ul>
</div>
</body>
</html>
