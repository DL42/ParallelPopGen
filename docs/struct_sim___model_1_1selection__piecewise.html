<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.12"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Parallel PopGen Package: Sim_Model::selection_piecewise&lt; Functor_sel1, Functor_sel2 &gt; Struct Template Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script><script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Parallel PopGen Package
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.12 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('struct_sim___model_1_1selection__piecewise.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="#pub-attribs">Public Attributes</a> &#124;
<a href="struct_sim___model_1_1selection__piecewise-members.html">List of all members</a>  </div>
  <div class="headertitle">
<div class="title">Sim_Model::selection_piecewise&lt; Functor_sel1, Functor_sel2 &gt; Struct Template Reference<div class="ingroups"><a class="el" href="group__selection.html">Simulation Models: Selection Group</a></div></div>  </div>
</div><!--header-->
<div class="contents">

<p>functor: selection function changes from <code>s1</code> to <code>s2</code> at generation <code>inflection_point</code>  
 <a href="struct_sim___model_1_1selection__piecewise.html#details">More...</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:aa636908f82dd8ac68d26779dbf6c9e63"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="struct_sim___model_1_1selection__piecewise.html#aa636908f82dd8ac68d26779dbf6c9e63">selection_piecewise</a> ()</td></tr>
<tr class="memdesc:aa636908f82dd8ac68d26779dbf6c9e63"><td class="mdescLeft">&#160;</td><td class="mdescRight">default constructor  <a href="#aa636908f82dd8ac68d26779dbf6c9e63">More...</a><br /></td></tr>
<tr class="separator:aa636908f82dd8ac68d26779dbf6c9e63"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac887be8dc0531afe948a3646902ad92e"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="struct_sim___model_1_1selection__piecewise.html#ac887be8dc0531afe948a3646902ad92e">selection_piecewise</a> (Functor_sel1 s1_in, Functor_sel2 s2_in, int <a class="el" href="struct_sim___model_1_1selection__piecewise.html#a3e8b8e91d906eed7152712b75926de73">inflection_point</a>, int <a class="el" href="struct_sim___model_1_1selection__piecewise.html#a3a6922239328eae6a8dae79c39354bc0">generation_shift</a>=0)</td></tr>
<tr class="memdesc:ac887be8dc0531afe948a3646902ad92e"><td class="mdescLeft">&#160;</td><td class="mdescRight">constructor  <a href="#ac887be8dc0531afe948a3646902ad92e">More...</a><br /></td></tr>
<tr class="separator:ac887be8dc0531afe948a3646902ad92e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1d0505a8710c8c473b83e21096b4ce18"><td class="memItemLeft" align="right" valign="top">__device__ __forceinline__ float&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="struct_sim___model_1_1selection__piecewise.html#a1d0505a8710c8c473b83e21096b4ce18">operator()</a> (const int population, const int generation, const float freq) const</td></tr>
<tr class="memdesc:a1d0505a8710c8c473b83e21096b4ce18"><td class="mdescLeft">&#160;</td><td class="mdescRight">selection operator, returns selection coefficient, <code>s</code>, for a given <code>population, generation, freq</code>  <a href="#a1d0505a8710c8c473b83e21096b4ce18">More...</a><br /></td></tr>
<tr class="separator:a1d0505a8710c8c473b83e21096b4ce18"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-attribs"></a>
Public Attributes</h2></td></tr>
<tr class="memitem:a3e8b8e91d906eed7152712b75926de73"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="struct_sim___model_1_1selection__piecewise.html#a3e8b8e91d906eed7152712b75926de73">inflection_point</a></td></tr>
<tr class="memdesc:a3e8b8e91d906eed7152712b75926de73"><td class="mdescLeft">&#160;</td><td class="mdescRight">generation in which the selection function switches from <code>s1</code> to <code>s2</code>  <a href="#a3e8b8e91d906eed7152712b75926de73">More...</a><br /></td></tr>
<tr class="separator:a3e8b8e91d906eed7152712b75926de73"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3a6922239328eae6a8dae79c39354bc0"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="struct_sim___model_1_1selection__piecewise.html#a3a6922239328eae6a8dae79c39354bc0">generation_shift</a></td></tr>
<tr class="memdesc:a3a6922239328eae6a8dae79c39354bc0"><td class="mdescLeft">&#160;</td><td class="mdescRight">number of generations to shift function backwards  <a href="#a3a6922239328eae6a8dae79c39354bc0">More...</a><br /></td></tr>
<tr class="separator:a3a6922239328eae6a8dae79c39354bc0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a35ab3b05d974d0201837a2d83f406901"><td class="memItemLeft" align="right" valign="top">Functor_sel1&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="struct_sim___model_1_1selection__piecewise.html#a35ab3b05d974d0201837a2d83f406901">s1</a></td></tr>
<tr class="memdesc:a35ab3b05d974d0201837a2d83f406901"><td class="mdescLeft">&#160;</td><td class="mdescRight">first selection function  <a href="#a35ab3b05d974d0201837a2d83f406901">More...</a><br /></td></tr>
<tr class="separator:a35ab3b05d974d0201837a2d83f406901"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af3b3be48cdf56ca7d44b39c4814ece98"><td class="memItemLeft" align="right" valign="top">Functor_sel2&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="struct_sim___model_1_1selection__piecewise.html#af3b3be48cdf56ca7d44b39c4814ece98">s2</a></td></tr>
<tr class="memdesc:af3b3be48cdf56ca7d44b39c4814ece98"><td class="mdescLeft">&#160;</td><td class="mdescRight">second selection function  <a href="#af3b3be48cdf56ca7d44b39c4814ece98">More...</a><br /></td></tr>
<tr class="separator:af3b3be48cdf56ca7d44b39c4814ece98"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><h3>template&lt;typename Functor_sel1, typename Functor_sel2&gt;<br />
struct Sim_Model::selection_piecewise&lt; Functor_sel1, Functor_sel2 &gt;</h3>

<p>functor: selection function changes from <code>s1</code> to <code>s2</code> at generation <code>inflection_point</code> </p>
<p>Takes in two template types: the function to be returned before the <code>inflection_point</code> and the function for after the <code>inflection_point</code>. <br />
Piecewise selection functors can be nested within each other and with population specific selection functors for multiple populations and multiple time functions, e.g.:<br />
<br />
3 populations with different selection coefficients where mutations in the 1st are neutral, in the 2nd are deleterious, and in the 3rd are beneficial up to generation 300 when selection relaxes and they become neutral </p><div class="fragment"><div class="line"><span class="keyword">typedef</span> <a class="code" href="struct_sim___model_1_1selection__constant.html">Sim_Model::selection_constant</a> constant;</div><div class="line"><span class="keyword">typedef</span> <a class="code" href="struct_sim___model_1_1selection__piecewise.html">Sim_Model::selection_piecewise&lt;constant,constant&gt;</a> piecewise_constant;</div><div class="line"><span class="keyword">typedef</span> <a class="code" href="struct_sim___model_1_1selection__population__specific.html">Sim_Model::selection_population_specific&lt;constant,constant&gt;</a> population_specific_constant;</div><div class="line">constant neutral;</div><div class="line">constant purifying(-0.01);</div><div class="line">constant positive(0.01);</div><div class="line">population_specific_constant first_second(neutral,purifying,1);</div><div class="line">piecewise_constant third(positive,neutral,300);</div><div class="line"><a class="code" href="struct_sim___model_1_1selection__population__specific.html">Sim_Model::selection_population_specific&lt;population_specific_constant,piecewise_constant&gt;</a> selection_model(first_second,third,2);</div></div><!-- fragment --><p> The modularity of these functor templates allow selection models to be extended to any number of populations and piecewise selection functions (including user defined functions). </p>

<p>Definition at line <a class="el" href="go__fish_8cuh_source.html#l00085">85</a> of file <a class="el" href="go__fish_8cuh_source.html">go_fish.cuh</a>.</p>
</div><h2 class="groupheader">Constructor &amp; Destructor Documentation</h2>
<a id="aa636908f82dd8ac68d26779dbf6c9e63"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa636908f82dd8ac68d26779dbf6c9e63">&sect;&nbsp;</a></span>selection_piecewise() <span class="overload">[1/2]</span></h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename Functor_sel1 , typename Functor_sel2 &gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="struct_sim___model_1_1selection__piecewise.html">Sim_Model::selection_piecewise</a>&lt; Functor_sel1, Functor_sel2 &gt;::<a class="el" href="struct_sim___model_1_1selection__piecewise.html">selection_piecewise</a> </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>default constructor </p>
<p><code>inflection_point = 0</code> <br />
 <code>generation_shift = 0</code> <br />
Function <code>s1</code> assigned default constructor of <code>Functor_sel1</code><br />
Function <code>s2</code> assigned default constructor of <code>Functor_sel2</code> </p>

<p>Definition at line <a class="el" href="template__inline__simulation__functors_8cuh_source.html#l00148">148</a> of file <a class="el" href="template__inline__simulation__functors_8cuh_source.html">template_inline_simulation_functors.cuh</a>.</p>

</div>
</div>
<a id="ac887be8dc0531afe948a3646902ad92e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac887be8dc0531afe948a3646902ad92e">&sect;&nbsp;</a></span>selection_piecewise() <span class="overload">[2/2]</span></h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename Functor_sel1 , typename Functor_sel2 &gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="struct_sim___model_1_1selection__piecewise.html">Sim_Model::selection_piecewise</a>&lt; Functor_sel1, Functor_sel2 &gt;::<a class="el" href="struct_sim___model_1_1selection__piecewise.html">selection_piecewise</a> </td>
          <td>(</td>
          <td class="paramtype">Functor_sel1&#160;</td>
          <td class="paramname"><em>s1_in</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Functor_sel2&#160;</td>
          <td class="paramname"><em>s2_in</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>inflection_point</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>generation_shift</em> = <code>0</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>constructor </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">generation_shift</td><td>(optional input) default <code>0</code> </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="template__inline__simulation__functors_8cuh_source.html#l00151">151</a> of file <a class="el" href="template__inline__simulation__functors_8cuh_source.html">template_inline_simulation_functors.cuh</a>.</p>

</div>
</div>
<h2 class="groupheader">Member Function Documentation</h2>
<a id="a1d0505a8710c8c473b83e21096b4ce18"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1d0505a8710c8c473b83e21096b4ce18">&sect;&nbsp;</a></span>operator()()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename Functor_sel1 , typename Functor_sel2 &gt; </div>
      <table class="memname">
        <tr>
          <td class="memname">__device__ __forceinline__ float <a class="el" href="struct_sim___model_1_1selection__piecewise.html">Sim_Model::selection_piecewise</a>&lt; Functor_sel1, Functor_sel2 &gt;::operator() </td>
          <td>(</td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>population</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>generation</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const float&#160;</td>
          <td class="paramname"><em>freq</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>selection operator, returns selection coefficient, <code>s</code>, for a given <code>population, generation, freq</code> </p>
<p><code>if(generation &gt;= inflection_point+generation_shift) s = s2(population, generation-generation_shift, freq)</code><br />
<code>else s = s1(population, generation-generation_shift, freq)</code> </p>

<p>Definition at line <a class="el" href="template__inline__simulation__functors_8cuh_source.html#l00155">155</a> of file <a class="el" href="template__inline__simulation__functors_8cuh_source.html">template_inline_simulation_functors.cuh</a>.</p>

</div>
</div>
<h2 class="groupheader">Member Data Documentation</h2>
<a id="a3e8b8e91d906eed7152712b75926de73"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3e8b8e91d906eed7152712b75926de73">&sect;&nbsp;</a></span>inflection_point</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename Functor_sel1 , typename Functor_sel2 &gt; </div>
      <table class="memname">
        <tr>
          <td class="memname">int <a class="el" href="struct_sim___model_1_1selection__piecewise.html">Sim_Model::selection_piecewise</a>&lt; Functor_sel1, Functor_sel2 &gt;::inflection_point</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>generation in which the selection function switches from <code>s1</code> to <code>s2</code> </p>

<p>Definition at line <a class="el" href="go__fish_8cuh_source.html#l00087">87</a> of file <a class="el" href="go__fish_8cuh_source.html">go_fish.cuh</a>.</p>

</div>
</div>
<a id="a3a6922239328eae6a8dae79c39354bc0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3a6922239328eae6a8dae79c39354bc0">&sect;&nbsp;</a></span>generation_shift</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename Functor_sel1 , typename Functor_sel2 &gt; </div>
      <table class="memname">
        <tr>
          <td class="memname">int <a class="el" href="struct_sim___model_1_1selection__piecewise.html">Sim_Model::selection_piecewise</a>&lt; Functor_sel1, Functor_sel2 &gt;::generation_shift</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>number of generations to shift function backwards </p>
<p>useful if you are starting the simulation from a previous simulation state and this function is expecting to start at 0 or any scenario where you want to shift the generation of the function relative to the simulation generation </p>

<p>Definition at line <a class="el" href="go__fish_8cuh_source.html#l00088">88</a> of file <a class="el" href="go__fish_8cuh_source.html">go_fish.cuh</a>.</p>

</div>
</div>
<a id="a35ab3b05d974d0201837a2d83f406901"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a35ab3b05d974d0201837a2d83f406901">&sect;&nbsp;</a></span>s1</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename Functor_sel1 , typename Functor_sel2 &gt; </div>
      <table class="memname">
        <tr>
          <td class="memname">Functor_sel1 <a class="el" href="struct_sim___model_1_1selection__piecewise.html">Sim_Model::selection_piecewise</a>&lt; Functor_sel1, Functor_sel2 &gt;::s1</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>first selection function </p>

<p>Definition at line <a class="el" href="go__fish_8cuh_source.html#l00089">89</a> of file <a class="el" href="go__fish_8cuh_source.html">go_fish.cuh</a>.</p>

</div>
</div>
<a id="af3b3be48cdf56ca7d44b39c4814ece98"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af3b3be48cdf56ca7d44b39c4814ece98">&sect;&nbsp;</a></span>s2</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename Functor_sel1 , typename Functor_sel2 &gt; </div>
      <table class="memname">
        <tr>
          <td class="memname">Functor_sel2 <a class="el" href="struct_sim___model_1_1selection__piecewise.html">Sim_Model::selection_piecewise</a>&lt; Functor_sel1, Functor_sel2 &gt;::s2</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>second selection function </p>

<p>Definition at line <a class="el" href="go__fish_8cuh_source.html#l00090">90</a> of file <a class="el" href="go__fish_8cuh_source.html">go_fish.cuh</a>.</p>

</div>
</div>
<hr/>The documentation for this struct was generated from the following files:<ul>
<li>src/3P/<a class="el" href="go__fish_8cuh_source.html">go_fish.cuh</a></li>
<li>src/3P/_internal/<a class="el" href="template__inline__simulation__functors_8cuh_source.html">template_inline_simulation_functors.cuh</a></li>
</ul>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="namespace_sim___model.html">Sim_Model</a></li><li class="navelem"><a class="el" href="struct_sim___model_1_1selection__piecewise.html">selection_piecewise</a></li>
    <li class="footer">Generated by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.12 </li>
  </ul>
</div>
</body>
</html>
